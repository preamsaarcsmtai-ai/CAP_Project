<div class="min-vh-100 bg-light">
  <!-- Header -->
  <div class="bg-white border-bottom shadow-sm py-3">
    <div class="container d-flex justify-content-between align-items-center">
      <div>
        <button class="btn btn-outline-secondary btn-sm me-2" (click)="onBack.emit()">
          ‚Üê Back to Dashboard
        </button>
        <span class="badge bg-secondary">{{ test.name }}</span>
      </div>

      <div class="d-flex align-items-center gap-3">
        <div>
          <span class="me-2">
            <i class="bi bi-camera-video" [ngClass]="{'text-success': cameraActive, 'text-danger': !cameraActive}"></i>
            {{ cameraActive ? 'Recording' : 'Offline' }}
          </span>
          <span class="me-2">
            <i class="bi bi-mic-fill text-success"></i> Audio
          </span>
          <span><i class="bi bi-shield-lock text-primary"></i> Secure</span>
        </div>
        <div class="bg-light px-3 py-1 rounded">
          <i class="bi bi-clock text-warning me-1"></i>
          <strong>{{ formatTime(timeRemaining) }}</strong>
        </div>
      </div>
    </div>
  </div>

  <div class="container my-4">
    <!-- Warnings -->
    <div *ngIf="warnings.length > 0" class="alert alert-warning">
      <i class="bi bi-exclamation-triangle-fill me-2"></i>
      <span *ngFor="let warning of warnings">{{ warning }}</span>
    </div>

    <!-- Progress -->
    <div class="mb-3">
      <h6>Question {{ currentQuestion + 1 }} of {{ test.questions.length }}</h6>
      <div class="progress">
        <div class="progress-bar" role="progressbar"
          [style.width.%]="((currentQuestion+1)/test.questions.length)*100">
        </div>
      </div>
    </div>

    <!-- Question Card -->
    <div class="card shadow-sm mb-4">
      <div class="card-header">
        <h5>{{ test.questions[currentQuestion].question }}</h5>
      </div>
      <div class="card-body">
        <div *ngFor="let option of test.questions[currentQuestion].options" class="form-check mb-2">
          <input class="form-check-input"
                 type="radio"
                 [name]="'q' + test.questions[currentQuestion].id"
                 [value]="option"
                 [checked]="answers[test.questions[currentQuestion].id] === option"
                 (change)="selectAnswer(option, test.questions[currentQuestion].id)">
          <label class="form-check-label">{{ option }}</label>
        </div>
      </div>
    </div>

    <!-- Navigation -->
    <div class="d-flex justify-content-between">
      <button class="btn btn-outline-secondary"
              (click)="prevQuestion()"
              [disabled]="currentQuestion === 0">
        ‚Üê Previous
      </button>

      <div>
        <button class="btn btn-outline-warning me-2">
          üö© Flag for Review
        </button>

        <button *ngIf="currentQuestion === test.questions.length - 1"
                class="btn btn-success"
                (click)="handleSubmit()">
          Submit Test
        </button>
        <button *ngIf="currentQuestion < test.questions.length - 1"
                class="btn btn-primary"
                (click)="nextQuestion()">
          Next ‚Üí
        </button>
      </div>
    </div>
  </div>
</div>
